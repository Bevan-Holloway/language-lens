<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Language Lens</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            min-height: 100vh;
            padding: 2rem 1rem;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 2.5rem 3rem;
            border-radius: 0.5rem;
            margin-bottom: 2.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        h1 {
            color: #1e3a5f;
            font-size: 2.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            letter-spacing: -0.02em;
        }

        .subtitle {
            color: #64748b;
            font-size: 1.05rem;
            margin-bottom: 2rem;
            font-weight: 400;
        }

        .controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 0.875rem 1.25rem 0.875rem 3rem;
            border: 1.5px solid #e2e8f0;
            border-radius: 0.375rem;
            font-size: 1rem;
            transition: all 0.2s;
            background: #f8fafc;
        }

        .search-box input:focus {
            outline: none;
            border-color: #1e3a5f;
            background: white;
            box-shadow: 0 0 0 3px rgba(30, 58, 95, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
            font-size: 1.1rem;
        }

        .mode-toggle {
            background: #1e3a5f;
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .mode-toggle:hover {
            background: #2c4a6f;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 58, 95, 0.2);
        }

        .mode-toggle:active {
            transform: translateY(0);
        }

        /* Reference Gallery Mode */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 0.5rem;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .feature-name {
            color: #1e3a5f;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            letter-spacing: -0.01em;
        }

        .bookmark-btn {
            background: none;
            border: none;
            font-size: 1.35rem;
            cursor: pointer;
            opacity: 0.2;
            transition: opacity 0.2s;
            padding: 0.25rem;
        }

        .bookmark-btn:hover {
            opacity: 0.6;
        }

        .bookmark-btn.active {
            opacity: 1;
            color: #1e3a5f;
        }

        .definition {
            color: #475569;
            margin-bottom: 1.25rem;
            line-height: 1.7;
            font-size: 0.975rem;
        }

        .example {
            font-style: italic;
            color: #64748b;
            margin-bottom: 1.5rem;
            padding: 1rem 1.25rem;
            background: #f8fafc;
            border-radius: 0.375rem;
            border-left: 3px solid #cbd5e1;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .analysis-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            padding: 1.25rem 1.5rem;
            border-radius: 0.375rem;
            border: 1px solid #bae6fd;
            margin-bottom: 1rem;
        }

        .purpose-section {
            background: linear-gradient(135deg, #fffbf5, #fef5e7);
            padding: 1.25rem 1.5rem;
            border-radius: 0.375rem;
            border: 1px solid #fde8cc;
        }

        .section-label {
            color: #0c4a6e;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .purpose-section .section-label {
            color: #92400e;
        }

        .effect-text {
            color: #334155;
            line-height: 1.6;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .analysis-questions {
            color: #0c4a6e;
            font-weight: 600;
            margin-bottom: 0.625rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .questions-list {
            list-style: none;
            padding: 0;
        }

        .questions-list li {
            color: #334155;
            line-height: 1.6;
            margin-bottom: 0.5rem;
            padding-left: 1.25rem;
            position: relative;
            font-size: 0.925rem;
        }

        .questions-list li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: #0c4a6e;
            font-weight: bold;
        }

        .purpose-section .questions-list li::before {
            color: #92400e;
        }

        .questions-list li:last-child {
            margin-bottom: 0;
        }

        .purpose-item {
            margin-bottom: 0.875rem;
        }

        .purpose-item:last-child {
            margin-bottom: 0;
        }

        .purpose-heading {
            color: #b45309;
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .purpose-text {
            color: #334155;
            font-size: 0.9rem;
            line-height: 1.5;
            font-style: italic;
        }

        /* Flashcard Mode */
        .flashcard-container {
            display: none;
            max-width: 800px;
            margin: 0 auto;
        }

        .flashcard-container.active {
            display: block;
        }

        .flashcard {
            background: white;
            border-radius: 0.5rem;
            padding: 3.5rem 3rem;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            min-height: 450px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .flashcard:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        .flashcard-front {
            text-align: center;
        }

        .flashcard-front .feature-name {
            font-size: 2.75rem;
            color: #1e3a5f;
            justify-content: center;
            margin-bottom: 2.5rem;
        }

        .flashcard-front .tap-hint {
            color: #94a3b8;
            font-size: 0.95rem;
            margin-top: 2.5rem;
        }

        .flashcard-back {
            display: none;
        }

        .flashcard.flipped .flashcard-front {
            display: none;
        }

        .flashcard.flipped .flashcard-back {
            display: block;
        }

        .flashcard-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
        }

        .nav-btn {
            background: #1e3a5f;
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-btn:hover:not(:disabled) {
            background: #2c4a6f;
            transform: translateY(-1px);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .card-counter {
            color: #475569;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .hidden {
            display: none !important;
        }

        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: #64748b;
            font-size: 1.1rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            header {
                padding: 1.5rem;
            }

            h1 {
                font-size: 1.75rem;
            }

            .gallery {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .feature-card {
                padding: 1.5rem;
            }

            .flashcard {
                padding: 2rem 1.5rem;
            }

            .flashcard-front .feature-name {
                font-size: 2rem;
            }
        }

        @media print {
            body {
                background: white;
            }

            .controls, .mode-toggle, .bookmark-btn {
                display: none !important;
            }

            .feature-card {
                break-inside: avoid;
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Language Lens</h1>
            <p class="subtitle">A comprehensive guide to literary and language devices for text analysis</p>
            
            <div class="controls">
                <div class="search-box">
                    <span class="search-icon">🔍</span>
                    <input type="text" id="searchInput" placeholder="Search features...">
                </div>
                <button class="mode-toggle" id="modeToggle">Switch to Flashcard Mode</button>
            </div>
        </header>

        <!-- Reference Gallery Mode -->
        <div class="gallery" id="gallery"></div>
        <div class="no-results hidden" id="noResults">No features found matching your search.</div>

        <!-- Flashcard Mode -->
        <div class="flashcard-container" id="flashcardContainer">
            <div class="flashcard" id="flashcard">
                <div class="flashcard-front">
                    <div class="feature-name" id="flashcardName"></div>
                    <p class="tap-hint">Click to reveal details ▼</p>
                </div>
                <div class="flashcard-back">
                    <div class="feature-name" id="flashcardNameBack"></div>
                    <div class="definition" id="flashcardDefinition"></div>
                    <div class="example" id="flashcardExample"></div>
                    <div class="analysis-section" id="flashcardAnalysis"></div>
                    <div class="purpose-section" id="flashcardPurpose"></div>
                </div>
            </div>
            
            <div class="flashcard-navigation">
                <button class="nav-btn" id="prevBtn">← Previous</button>
                <div class="card-counter" id="counter"></div>
                <button class="nav-btn" id="nextBtn">Next →</button>
            </div>
        </div>
    </div>

    <script>
        // Access check - UNCOMMENT THIS IN PRODUCTION
        // (function checkAccess() {
        //     const accessCode = localStorage.getItem('languageFeaturesAccess');
        //     if (!accessCode) {
        //         window.location.href = 'index.html';
        //         return;
        //     }
        // })();

        const features = [
            {
                name: "Alliteration",
                definition: "The repetition of the same initial consonant sound in words that are close together in a phrase or sentence.",
                example: "Peter Piper picked a peck of pickled peppers.",
                effect: "Creates rhythm and draws attention to specific words or ideas.",
                questions: [
                    "What mood does the sound create - soft and soothing, or harsh and aggressive?",
                    "Which words are being emphasised through the repeated sound?",
                    "Why did the writer want to draw attention to these particular words?"
                ],
                purposes: {
                    connect: "How does this sound pattern draw on poetic or literary traditions you recognise?",
                    understand: "What emotion or memory does this sound evoke in you as a reader?",
                    recognise: "How does the writer use sound to make certain words stand out or stick in your mind?",
                    question: "Does the pleasant or harsh sound influence how you feel about what's being described?"
                }
            },
            {
                name: "Allusion",
                definition: "A brief and indirect reference to a person, place, thing, or idea of historical, cultural, literary, or political significance.",
                example: "He was a real Romeo with the ladies.",
                effect: "Adds depth by connecting to shared cultural knowledge and evoking associations.",
                questions: [
                    "What does the reader need to know to understand this reference?",
                    "What qualities or ideas does it bring to mind?",
                    "Why did the writer choose this particular reference?"
                ],
                purposes: {
                    connect: "How does this reference rely on shared cultural or literary knowledge?",
                    understand: "What does recognising (or not recognising) this reference tell you about yourself?",
                    recognise: "How does the writer use cultural shorthand to add layers of meaning?",
                    question: "Who is included and who is excluded by assuming this knowledge?"
                }
            },
            {
                name: "Analogy",
                definition: "A comparison between two different things to explain or clarify a complex idea.",
                example: "A doctor is to a hospital as a mechanic is to a garage.",
                effect: "Makes complex or abstract ideas easier to understand by relating them to familiar concepts.",
                questions: [
                    "What is being compared to what?",
                    "How does the familiar thing help explain the unfamiliar?",
                    "Why was this particular comparison chosen?"
                ],
                purposes: {
                    connect: "How does this analogy build on shared everyday experiences?",
                    understand: "What new understanding does this comparison give you?",
                    recognise: "How does the writer make difficult ideas accessible through comparison?",
                    question: "Does the analogy oversimplify or does it genuinely illuminate the concept?"
                }
            },
            {
                name: "Anaphora",
                definition: "The repetition of a word or phrase at the beginning of successive clauses or sentences.",
                example: "I have a dream... I have a dream...",
                effect: "Builds rhythm and emphasis, making ideas powerful and memorable.",
                questions: [
                    "What words or phrases are repeated at the start of each line?",
                    "How does the repetition build emotional intensity?",
                    "Why does the writer want to emphasise this particular idea?"
                ],
                purposes: {
                    connect: "How does this technique connect to speeches, sermons, or protest chants?",
                    understand: "What emotion does the building repetition create in you?",
                    recognise: "How does the writer use repetition to hammer home a message?",
                    question: "Whose voice and whose dream is being centred through this repetition?"
                }
            },
            {
                name: "Antithesis",
                definition: "Placing two contrasting ideas or words together in a balanced structure to highlight their differences.",
                example: "It was the best of times, it was the worst of times.",
                effect: "Creates drama and highlights contrasts, making differences more striking.",
                questions: [
                    "What two opposing ideas are being contrasted?",
                    "How does the balanced structure emphasise the opposition?",
                    "Why does the writer want to show this contrast?"
                ],
                purposes: {
                    connect: "How does this technique connect to philosophical or political debates?",
                    understand: "How does the contrast reflect contradictions in your own experience?",
                    recognise: "How does the writer use balanced opposites to create tension?",
                    question: "Does presenting two extremes erase the middle ground or nuance?"
                }
            },
            {
                name: "Assonance",
                definition: "The repetition of the same vowel sounds within words that are close to each other.",
                example: "The fleet-feet sweep by sleeping geese.",
                effect: "Adds musicality and flow to the text, creating a particular mood or tone.",
                questions: [
                    "What vowel sounds are being repeated?",
                    "How does this affect the pace and rhythm of the line?",
                    "Why did the writer want to create this particular sound quality?"
                ],
                purposes: {
                    connect: "How does this musical quality connect to oral storytelling or poetic traditions?",
                    understand: "What feeling or atmosphere does the repeated vowel sound create for you?",
                    recognise: "How does the writer use vowel sounds to control the pace and flow of reading?",
                    question: "Does the smooth or jarring sound affect how you interpret the meaning?"
                }
            },
            {
                name: "Hyperbole",
                definition: "The deliberate exaggeration of a statement for emphasis or effect.",
                example: "I've told you a million times.",
                effect: "Emphasises a point dramatically, often adding humour or intensity.",
                questions: [
                    "What is being exaggerated and by how much?",
                    "Does the exaggeration create humour, frustration, or another emotion?",
                    "Why did the writer choose to overstate rather than state plainly?"
                ],
                purposes: {
                    connect: "How does exaggeration appear in tall tales, comedy, and everyday speech?",
                    understand: "What emotion drives you to exaggerate in your own life?",
                    recognise: "How does the writer use exaggeration to emphasise or entertain?",
                    question: "Does the exaggeration hide or reveal the truth?"
                }
            },
            {
                name: "Imagery",
                definition: "The use of vivid and descriptive language to create a mental picture for the reader, appealing to the five senses.",
                example: "The acidic scent of pine needles filled the crisp, morning air.",
                effect: "Makes writing immersive by helping readers experience what is being described.",
                questions: [
                    "Which senses does this appeal to (sight, sound, smell, taste, touch)?",
                    "What atmosphere or mood does the imagery create?",
                    "Why does the writer want us to experience this particular sensation?"
                ],
                purposes: {
                    connect: "How does this sensory description connect to universal human experiences?",
                    understand: "What memories or emotions does this sensory detail trigger for you personally?",
                    recognise: "How does the writer use specific sensory details to create atmosphere and mood?",
                    question: "Whose sensory experience is centred - might others experience this place differently?"
                }
            },
            {
                name: "Irony",
                definition: "A contrast between what is said and what is actually meant, or between what happens and what is expected to happen.",
                example: "A fire station burning down (situational irony).",
                effect: "Creates surprise, humour, or reveals deeper meaning by highlighting contradictions.",
                questions: [
                    "What is the gap between expectation and reality?",
                    "What tone does this create - humorous, tragic, or critical?",
                    "Why does the writer want to highlight this contradiction?"
                ],
                purposes: {
                    connect: "How does irony connect to satire, comedy, or social critique in literature?",
                    understand: "What does the unexpected twist make you reconsider?",
                    recognise: "How does the writer use contradiction to create humour or criticism?",
                    question: "Who benefits and who suffers from the ironic situation?"
                }
            },
            {
                name: "Juxtaposition",
                definition: "Placing two contrasting elements side by side to highlight their differences.",
                example: "Placing a beggar next to a limousine to highlight economic inequality.",
                effect: "Emphasises contrasts by forcing readers to compare and notice differences.",
                questions: [
                    "What two things are placed side by side?",
                    "What does their contrast reveal or emphasise?",
                    "Why does the writer want us to see these things together?"
                ],
                purposes: {
                    connect: "How does this technique appear in visual art, film, or social commentary?",
                    understand: "What emotions does the stark contrast create in you?",
                    recognise: "How does the writer use placement to create meaning and critique?",
                    question: "What power structures or inequalities does this contrast expose?"
                }
            },
            {
                name: "Listing",
                definition: "The inclusion of several items, ideas, or actions in a series.",
                example: "The market sold fresh fruits, crisp vegetables, artisanal cheeses, and baked breads.",
                effect: "Builds momentum, creates a sense of abundance or overwhelm, and provides detailed description.",
                questions: [
                    "Why list these specific items in this particular order?",
                    "Does the list create a sense of plenty, chaos, or something else?",
                    "Why did the writer choose to accumulate details this way?"
                ],
                purposes: {
                    connect: "How do lists appear in sacred texts, inventories, or cultural catalogues?",
                    understand: "Does the abundance or overwhelm of the list reflect your own experiences?",
                    recognise: "How does the writer use accumulation to create effect - richness or excess?",
                    question: "What is included in this list and what is left out - whose world is being represented?"
                }
            },
            {
                name: "Metaphor",
                definition: "A direct comparison between two unlike things without using 'like' or 'as.' It states that one thing is another.",
                example: "The world is a stage.",
                effect: "Creates powerful connections and helps readers see things in new ways.",
                questions: [
                    "What two things are being compared?",
                    "What qualities are transferred from one to the other?",
                    "Why did the writer choose this particular comparison?"
                ],
                purposes: {
                    connect: "How does this metaphor draw on familiar cultural or literary references?",
                    understand: "What new way of seeing yourself or the world does this comparison offer?",
                    recognise: "How does this metaphor shape your emotional or intellectual response?",
                    question: "Whose worldview or values does this comparison reinforce or challenge?"
                }
            },
            {
                name: "Onomatopoeia",
                definition: "The use of words that imitate the sounds they describe.",
                example: "Buzz, hiss, or pop.",
                effect: "Brings sounds to life, making the writing more dynamic and sensory.",
                questions: [
                    "What sound is being imitated?",
                    "How does hearing this sound affect the mood or atmosphere?",
                    "Why does the writer want us to 'hear' this moment?"
                ],
                purposes: {
                    connect: "How do sound words connect to the way we naturally describe our world?",
                    understand: "How does hearing this sound immerse you more deeply in the experience?",
                    recognise: "How does the writer use sound imitation to make the scene more vivid and immediate?",
                    question: "Whose experience of sound is being prioritised - could others hear it differently?"
                }
            },
            {
                name: "Oxymoron",
                definition: "A figure of speech that combines two contradictory terms.",
                example: "Jumbo shrimp or deafening silence.",
                effect: "Creates surprise and highlights complexity or contradiction.",
                questions: [
                    "What contradiction exists in these paired words?",
                    "What complex truth or irony is being revealed?",
                    "Why did the writer combine these opposing ideas?"
                ],
                purposes: {
                    connect: "How do oxymorons appear in everyday language and cultural expressions?",
                    understand: "What complex feelings or experiences does the contradiction capture?",
                    recognise: "How does the writer use contradiction to express complexity?",
                    question: "Does the contradiction reveal truth or confusion in our language?"
                }
            },
            {
                name: "Parallel Structure",
                definition: "The repetition of a chosen grammatical form within a sentence or a series of sentences.",
                example: "She likes reading, writing, and singing.",
                effect: "Creates balance, rhythm, and clarity, making ideas memorable and persuasive.",
                questions: [
                    "What grammatical pattern is being repeated?",
                    "How does the balance affect the rhythm of the sentence?",
                    "Why does the writer want these ideas to feel equally weighted?"
                ],
                purposes: {
                    connect: "How does this structure connect to speeches, religious texts, or formal writing?",
                    understand: "How does the balanced structure make the ideas feel fair or complete?",
                    recognise: "How does the writer use grammatical patterns to persuade or emphasise?",
                    question: "Does the balanced structure hide any inequality in the ideas presented?"
                }
            },
            {
                name: "Personification",
                definition: "Giving human qualities or actions to inanimate objects or abstract ideas.",
                example: "The wind whispered through the trees.",
                effect: "Makes non-human things relatable and vivid by bringing them to life.",
                questions: [
                    "What non-human thing is being given human qualities?",
                    "What human characteristics are assigned to it?",
                    "Why does the writer want us to see this thing as human-like?"
                ],
                purposes: {
                    connect: "How does this connect to myths, fables, or cultural stories about nature?",
                    understand: "How does seeing nature as alive change your relationship with it?",
                    recognise: "How does the writer make abstract or distant things feel closer and more relatable?",
                    question: "Does treating nature as human help us care for it, or does it centre human experience?"
                }
            },
            {
                name: "Repetition",
                definition: "The simple act of repeating a word, phrase, or sentence.",
                example: "The politician promised change, change, and more change.",
                effect: "Emphasises key ideas and creates rhythm, building intensity or urgency.",
                questions: [
                    "What specific words or phrases are being repeated?",
                    "How does the repetition affect the tone or emotional intensity?",
                    "Why does the writer want to hammer this point home?"
                ],
                purposes: {
                    connect: "How does repetition connect to advertising, political slogans, or cultural mantras?",
                    understand: "Does the repetition convince you or make you suspicious?",
                    recognise: "How does the writer use repetition to persuade or manipulate?",
                    question: "Is the repetition used to inspire or to overwhelm critical thinking?"
                }
            },
            {
                name: "Rhetorical Question",
                definition: "A question asked for effect rather than to elicit an answer.",
                example: "Are we going to sit here and do nothing?",
                effect: "Provokes thought and engages the reader, often implying an obvious answer.",
                questions: [
                    "What is the implied or obvious answer to this question?",
                    "How does this engage or challenge the reader?",
                    "Why did the writer choose to question rather than state directly?"
                ],
                purposes: {
                    connect: "How do rhetorical questions appear in speeches, debates, and persuasive texts?",
                    understand: "How does being questioned make you feel - challenged, engaged, or manipulated?",
                    recognise: "How does the writer use questions to guide you toward a particular answer?",
                    question: "Does the 'obvious' answer really allow for other perspectives?"
                }
            },
            {
                name: "Rhyme",
                definition: "The repetition of similar sounds in the final stressed syllables of two or more words, most often at the ends of lines in poems and songs.",
                example: "The cat sat on the mat / with a funny little hat.",
                effect: "Creates musical quality, structure, and makes ideas more memorable.",
                questions: [
                    "What is the rhyme scheme or pattern?",
                    "How does the rhyme affect the rhythm and flow?",
                    "Why did the writer choose to use rhyme here?"
                ],
                purposes: {
                    connect: "How does rhyme connect this text to traditional forms of poetry or song?",
                    understand: "What childhood memories or emotions does the rhyme evoke?",
                    recognise: "How does the writer use rhyme to create structure and aid memory?",
                    question: "Does the playful or serious tone of the rhyme affect how you take the message?"
                }
            },
            {
                name: "Sibilance",
                definition: "The repetition of hissing sounds, typically 's,' 'sh,' 'z,' or 'ch,' in close succession within a phrase or sentence.",
                example: "The snake hissed silently in the grass.",
                effect: "Creates a specific sound quality that can feel smooth and flowing or ominous and sinister.",
                questions: [
                    "What mood does the hissing sound create?",
                    "Is it soothing, sinister, or something else?",
                    "Why did the writer want this particular sound quality?"
                ],
                purposes: {
                    connect: "How does this hissing sound connect to cultural associations (snakes, secrets, whispers)?",
                    understand: "What feeling does the 's' sound trigger in you - comfort or unease?",
                    recognise: "How does the writer manipulate sound to create atmosphere?",
                    question: "Does the sound reinforce stereotypes (evil snakes) or challenge them?"
                }
            },
            {
                name: "Simile",
                definition: "A direct comparison between two different things using the words 'like' or 'as.'",
                example: "She is as brave as a lion.",
                effect: "Makes descriptions vivid by comparing to something familiar.",
                questions: [
                    "What two things are being compared?",
                    "What quality is being highlighted through the comparison?",
                    "Why did the writer choose this particular comparison?"
                ],
                purposes: {
                    connect: "How does this comparison rely on shared cultural knowledge or stereotypes?",
                    understand: "How does the comparison help you visualise or understand the subject?",
                    recognise: "How does the writer use familiar things to explain unfamiliar concepts?",
                    question: "Does the comparison rely on cultural assumptions that might not be universal?"
                }
            },
            {
                name: "Symbolism",
                definition: "The use of an object, person, or idea to represent a deeper, more abstract concept.",
                example: "A dove often symbolises peace.",
                effect: "Adds layers of meaning, allowing complex ideas to be communicated indirectly.",
                questions: [
                    "What is the symbol and what does it represent?",
                    "How do you know what it symbolises - is it cultural, contextual, or stated?",
                    "Why did the writer choose to communicate this idea symbolically?"
                ],
                purposes: {
                    connect: "How does this symbol draw on religious, cultural, or literary traditions?",
                    understand: "What personal meaning or memory does this symbol hold for you?",
                    recognise: "How does the writer layer meaning through symbols rather than direct statement?",
                    question: "Whose culture or belief system does this symbol come from?"
                }
            },
            {
                name: "Triad",
                definition: "A specific type of parallelism where three items are listed in a series. This is often called 'the rule of three.'",
                example: "Veni, vidi, vici (I came, I saw, I conquered).",
                effect: "Creates a sense of completeness and rhythm, making ideas memorable and impactful.",
                questions: [
                    "Why these three items specifically?",
                    "How does the order contribute to the effect?",
                    "Why did the writer stop at three rather than two or four?"
                ],
                purposes: {
                    connect: "How does the 'rule of three' appear in fairy tales, speeches, and cultural sayings?",
                    understand: "Why does three feel complete or satisfying to you?",
                    recognise: "How does the writer use the power of three to make ideas stick?",
                    question: "What is excluded by limiting the list to three things?"
                }
            }
        ];

        // Sort features alphabetically
        features.sort((a, b) => a.name.localeCompare(b.name));

        // State
        let currentMode = 'gallery';
        let currentCardIndex = 0;
        let filteredFeatures = [...features];
        let bookmarks = JSON.parse(localStorage.getItem('languageFeatureBookmarks') || '[]');

        // Elements
        const gallery = document.getElementById('gallery');
        const flashcardContainer = document.getElementById('flashcardContainer');
        const modeToggle = document.getElementById('modeToggle');
        const searchInput = document.getElementById('searchInput');
        const noResults = document.getElementById('noResults');
        const flashcard = document.getElementById('flashcard');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const counter = document.getElementById('counter');

        // Initialize
        renderGallery();

        // Mode Toggle
        modeToggle.addEventListener('click', () => {
            if (currentMode === 'gallery') {
                currentMode = 'flashcard';
                gallery.classList.add('hidden');
                noResults.classList.add('hidden');
                flashcardContainer.classList.add('active');
                modeToggle.textContent = 'Switch to Reference Mode';
                searchInput.disabled = true;
                renderFlashcard();
            } else {
                currentMode = 'gallery';
                gallery.classList.remove('hidden');
                flashcardContainer.classList.remove('active');
                modeToggle.textContent = 'Switch to Flashcard Mode';
                searchInput.disabled = false;
                flashcard.classList.remove('flipped');
            }
        });

        // Search
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            filteredFeatures = features.filter(f => 
                f.name.toLowerCase().includes(searchTerm) ||
                f.definition.toLowerCase().includes(searchTerm) ||
                f.effect.toLowerCase().includes(searchTerm)
            );
            renderGallery();
        });

        // Render Gallery
        function renderGallery() {
            gallery.innerHTML = '';
            
            if (filteredFeatures.length === 0) {
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            
            filteredFeatures.forEach((feature) => {
                const card = document.createElement('div');
                card.className = 'feature-card';
                
                const isBookmarked = bookmarks.includes(feature.name);
                
                const questionsList = feature.questions.map(q => `<li>${q}</li>`).join('');
                
                card.innerHTML = `
                    <div class="feature-name">
                        <span>${feature.name}</span>
                        <button class="bookmark-btn ${isBookmarked ? 'active' : ''}" data-name="${feature.name}">
                            ${isBookmarked ? '★' : '☆'}
                        </button>
                    </div>
                    <div class="definition">${feature.definition}</div>
                    <div class="example">"${feature.example}"</div>
                    <div class="analysis-section">
                        <div class="section-label">Effect</div>
                        <div class="effect-text">${feature.effect}</div>
                        <div class="analysis-questions">When Analysing, Ask</div>
                        <ul class="questions-list">
                            ${questionsList}
                        </ul>
                    </div>
                    <div class="purpose-section">
                        <div class="section-label">Why This Matters</div>
                        <div class="purpose-item">
                            <div class="purpose-heading">Connect to the Wider World:</div>
                            <div class="purpose-text">${feature.purposes.connect}</div>
                        </div>
                        <div class="purpose-item">
                            <div class="purpose-heading">Understand Ourselves:</div>
                            <div class="purpose-text">${feature.purposes.understand}</div>
                        </div>
                        <div class="purpose-item">
                            <div class="purpose-heading">Recognise the Craft:</div>
                            <div class="purpose-text">${feature.purposes.recognise}</div>
                        </div>
                        <div class="purpose-item">
                            <div class="purpose-heading">Question the Text:</div>
                            <div class="purpose-text">${feature.purposes.question}</div>
                        </div>
                    </div>
                `;
                
                gallery.appendChild(card);
            });

            // Bookmark handlers
            document.querySelectorAll('.bookmark-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const name = btn.dataset.name;
                    toggleBookmark(name);
                });
            });
        }

        // Bookmark toggle
        function toggleBookmark(name) {
            const index = bookmarks.indexOf(name);
            if (index > -1) {
                bookmarks.splice(index, 1);
            } else {
                bookmarks.push(name);
            }
            localStorage.setItem('languageFeatureBookmarks', JSON.stringify(bookmarks));
            renderGallery();
        }

        // Flashcard functionality
        function renderFlashcard() {
            const feature = features[currentCardIndex];
            
            const questionsList = feature.questions.map(q => `<li>${q}</li>`).join('');
            
            document.getElementById('flashcardName').textContent = feature.name;
            document.getElementById('flashcardNameBack').textContent = feature.name;
            document.getElementById('flashcardDefinition').textContent = feature.definition;
            document.getElementById('flashcardExample').textContent = `"${feature.example}"`;
            document.getElementById('flashcardAnalysis').innerHTML = `
                <div class="section-label">Effect</div>
                <div class="effect-text">${feature.effect}</div>
                <div class="analysis-questions">When Analysing, Ask</div>
                <ul class="questions-list">
                    ${questionsList}
                </ul>
            `;
            document.getElementById('flashcardPurpose').innerHTML = `
                <div class="section-label">Why This Matters</div>
                <div class="purpose-item">
                    <div class="purpose-heading">Connect to the Wider World:</div>
                    <div class="purpose-text">${feature.purposes.connect}</div>
                </div>
                <div class="purpose-item">
                    <div class="purpose-heading">Understand Ourselves:</div>
                    <div class="purpose-text">${feature.purposes.understand}</div>
                </div>
                <div class="purpose-item">
                    <div class="purpose-heading">Recognise the Craft:</div>
                    <div class="purpose-text">${feature.purposes.recognise}</div>
                </div>
                <div class="purpose-item">
                    <div class="purpose-heading">Question the Text:</div>
                    <div class="purpose-text">${feature.purposes.question}</div>
                </div>
            `;
            
            counter.textContent = `${currentCardIndex + 1} of ${features.length}`;
            
            prevBtn.disabled = currentCardIndex === 0;
            nextBtn.disabled = currentCardIndex === features.length - 1;
        }

        flashcard.addEventListener('click', () => {
            flashcard.classList.toggle('flipped');
        });

        prevBtn.addEventListener('click', () => {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                flashcard.classList.remove('flipped');
                renderFlashcard();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentCardIndex < features.length - 1) {
                currentCardIndex++;
                flashcard.classList.remove('flipped');
                renderFlashcard();
            }
        });

        // Keyboard navigation in flashcard mode
        document.addEventListener('keydown', (e) => {
            if (currentMode === 'flashcard') {
                if (e.key === 'ArrowLeft') prevBtn.click();
                if (e.key === 'ArrowRight') nextBtn.click();
                if (e.key === ' ' || e.key === 'Enter') {
                    e.preventDefault();
                    flashcard.classList.toggle('flipped');
                }
            }
        });
    </script>
</body>
</html>